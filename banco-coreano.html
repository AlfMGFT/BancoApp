<link rel="import" href="../polymer/polymer-element.html">

<dom-module id="banco-coreano">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>
    <h2>Banco Coreano: [[currency]], [[amount]], [[max_amount]]!</h2>
    <paper-input id="ingresaBCor" label="Ingresa Dinero"></paper-input>
    <paper-button on-tap="_ingresaDinero">Ingresa Dinero</paper-button>
    <paper-input id="retiraBCor" label="Retira Dinero"></paper-input>
    <paper-button on-tap="_retiraDinero">Retira Dinero</paper-button>
  </template>

  <script>
    /**
     * `banco-coreano`
     * &#34;Banco app&#34;
     *
     * @customElement
     * @polymer
     * @demo demo/index.html
     */
    class BancoCoreano extends Polymer.Element {
      static get is() { return 'banco-coreano'; }
      static get properties() {
        return {
          currency: {
            type: String,
            value: 'WON',
            readyOnly: true
          },
          amount: {
            type: Number,
            value: 0,
            notify: true
          },
          max_amount: {
            type: Number,
            value: 2000,
            notify: true
          }
        };
      }
      _ingresaDinero() {
        console.log(this.max_amount);
        //console.log(this.$.ingresaBCor.value);
        if (Math.sign(this.$.ingresaBCor.value) === 1) {
          if (this.amount < this.max_amount) {
            this.amount += parseInt(this.$.ingresaBCor.value);
            this.dispatchEvent(new CustomEvent('success', {
              detail: {
                isOnDOM: true,
                message: 'Banco Coreano: se ha ingresado dinero a la cuenta por el monto de: ' + this.$.ingresaBCor.value + ' ' + this.currency,
              }
            }));
          } else {
            console.log("el maximo monto supera los 2000");
            this.dispatchEvent(new CustomEvent('error', {
              detail: {
                isOnDOM: true,
                message: 'Banco Coreano: se ha producido un error el mÃ¡ximo monto supera los 2000' + ' ' + this.currency,
              }
            }));
          }
        } else {
          console.log("0 o - error");
          this.dispatchEvent(new CustomEvent('error', {
            detail: {
              isOnDOM: true,
              message: 'Banco Coreano: se ha producido un error la cantidad ingresada es erronea',
            }
          }));
        }
      }
      _retiraDinero() {
        console.log(this.amount);
        //console.log(this.$.retiraBCor.value);
        if (Math.sign(this.$.retiraBCor.value) === 1) {
          if (this.$.retiraBCor.value <= this.max_amount && this.amount > 0) {
            //if (!(this.$.retiraBCor.value > this.amount)) {
            this.amount -= parseInt(this.$.retiraBCor.value);
            this.dispatchEvent(new CustomEvent('success', {
              detail: {
                isOnDOM: true,
                message: 'Banco Coreano: se ha retirado dinero a la cuenta por el monto de: ' + this.$.retiraBCor.value + ' ' + this.currency,
              }
            }));
          } else {
            console.log("el monto supera los 2000")
            this.dispatchEvent(new CustomEvent('error', {
              detail: {
                isOnDOM: true,
                message: 'Banco Coreano: se ha producido un error no hay suficiente saldo para retirar',
              }
            }));
          }
        } else {
          console.log("0 o - error");
          this.dispatchEvent(new CustomEvent('error', {
            detail: {
              isOnDOM: true,
              message: 'Banco Coreano: se ha producido un error la cantidad retirada es erronea',
            }
          }));
        }
      }
    }

    window.customElements.define(BancoCoreano.is, BancoCoreano);
  </script>
</dom-module>